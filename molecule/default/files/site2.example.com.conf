# Ansible managed: Do NOT edit this file manually!

Define DOMAIN site2.example.com

<VirtualHost *:80>
    ServerName ${DOMAIN}
    ServerAdmin  webmaster@example.com
    DocumentRoot /var/www/html/${DOMAIN}

    <Directorymatch "^/.*/\.git+/">
      Require all denied
    </Directorymatch>
    <Files ~ "^\.git">
      Require all denied
    </Files>

    ProxyRequests     Off
    ProxyPreserveHost On
    AllowEncodedSlashes Off
    ProxyPass /.well-known !
    ProxyPass / https://proxy.example.com/
    ProxyPassReverse / https://proxy.example.com/
    CustomLog ${APACHE_LOG_DIR}/${DOMAIN}-access.log combined
    ErrorLog ${APACHE_LOG_DIR}/${DOMAIN}-error.log
</VirtualHost>

<IfModule mod_ssl.c>
    <VirtualHost *:443>
        ServerName ${DOMAIN}
        ServerAdmin  webmaster@example.com
        DocumentRoot /var/www/html/${DOMAIN}

        <Directorymatch "^/.*/\.git+/">
          Require all denied
        </Directorymatch>
        <Files ~ "^\.git">
          Require all denied
        </Files>

        SSLEngine on
        SSLCertificateFile    /etc/ssl/certs/ssl-cert-snakeoil.pem
        SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key

        SSLProxyEngine On
        ProxyRequests     Off
        ProxyPreserveHost On
        AllowEncodedSlashes Off
        ProxyPass /.well-known !
        ProxyPass / https://proxy.example.com/
        ProxyPassReverse / https://proxy.example.com/
        CustomLog ${APACHE_LOG_DIR}/${DOMAIN}-access.log combined
        ErrorLog ${APACHE_LOG_DIR}/${DOMAIN}-error.log
    </VirtualHost>
</IfModule>

# vim: syntax=apache ts=4 sw=4 sts=4 sr
